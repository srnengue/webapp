<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›ç­”åˆ†æ - ã«ã’ã¾ã£ã—</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 25px 30px;
            border-radius: 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title {
            font-size: 24px;
            color: #333;
            font-weight: 800;
        }

        .back-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .insight-card {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
        }

        .insight-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .insight-title {
            font-size: 16px;
            color: #666;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .insight-value {
            font-size: 36px;
            font-weight: 800;
            color: #FF6B6B;
            margin-bottom: 5px;
        }

        .insight-description {
            font-size: 13px;
            color: #999;
            line-height: 1.6;
        }

        .analysis-section {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 20px;
            color: #333;
            font-weight: 800;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .trend-chart {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .chart-placeholder {
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 18px;
            border: 3px dashed #e0e0e0;
            border-radius: 12px;
        }

        .recommendation-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .recommendation-item {
            display: flex;
            gap: 15px;
            padding: 20px;
            background: linear-gradient(135deg, #FFF0F0, #FFF9E6);
            border-radius: 15px;
            border-left: 5px solid #FF6B6B;
            transition: all 0.3s;
        }

        .recommendation-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.2);
        }

        .recommendation-icon {
            font-size: 32px;
        }

        .recommendation-content {
            flex: 1;
        }

        .recommendation-title {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
        }

        .recommendation-text {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }

        .priority-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 700;
            margin-left: 8px;
        }

        .priority-high {
            background: #FF6B6B;
            color: white;
        }

        .priority-medium {
            background: #FFB347;
            color: white;
        }

        .priority-low {
            background: #d0d0d0;
            color: #666;
        }

        .sentiment-analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .sentiment-item {
            text-align: center;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .sentiment-emoji {
            font-size: 64px;
            margin-bottom: 15px;
        }

        .sentiment-label {
            font-size: 14px;
            color: #666;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .sentiment-percentage {
            font-size: 32px;
            font-weight: 800;
            color: #333;
        }

        .keywords-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .keyword-tag {
            padding: 10px 18px;
            background: white;
            border: 2px solid #FF6B6B;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 700;
            color: #FF6B6B;
            transition: all 0.3s;
            cursor: pointer;
        }

        .keyword-tag:hover {
            background: #FF6B6B;
            color: white;
            transform: scale(1.05);
        }

        .keyword-count {
            font-size: 12px;
            opacity: 0.7;
            margin-left: 5px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 18px;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .insights-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="loading" id="loadingMessage">ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...</div>

        <div class="header" style="display: none;" id="mainContent">
            <div class="header-title">ğŸ“ˆ å›ç­”ãƒ‡ãƒ¼ã‚¿åˆ†æ</div>
            <button class="back-btn" onclick="goBack()">â† æˆ»ã‚‹</button>
        </div>

        <div class="insights-grid" style="display: none;" id="insightsGrid">
            <div class="insight-card">
                <div class="insight-icon">â­</div>
                <div class="insight-title">ç·åˆæº€è¶³åº¦</div>
                <div class="insight-value" id="avgSatisfaction">-<span style="font-size: 20px; color: #999;">/5.0</span></div>
                <div class="insight-description" id="satisfactionDesc">ãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆä¸­...</div>
            </div>

            <div class="insight-card">
                <div class="insight-icon">ğŸ“Š</div>
                <div class="insight-title">å›ç­”å®Œäº†ç‡</div>
                <div class="insight-value" id="completionRate">-<span style="font-size: 20px; color: #999;">%</span></div>
                <div class="insight-description">é«˜ã„å›ç­”å®Œäº†ç‡ã‚’ç¶­æŒ</div>
            </div>

            <div class="insight-card">
                <div class="insight-icon">ğŸ¯</div>
                <div class="insight-title">æœ€é‡è¦èª²é¡Œ</div>
                <div class="insight-value" style="font-size: 18px;" id="topIssue">-</div>
                <div class="insight-description" id="topIssueDesc">-</div>
            </div>

            <div class="insight-card">
                <div class="insight-icon">âœ¨</div>
                <div class="insight-title">äººæ°—æ©Ÿèƒ½</div>
                <div class="insight-value" style="font-size: 18px;" id="topFeature">-</div>
                <div class="insight-description" id="topFeatureDesc">-</div>
            </div>
        </div>

        <div class="analysis-section" style="display: none;" id="trendSection">
            <div class="section-title">
                <span>ğŸ“ˆ</span>
                <span>å›ç­”ãƒˆãƒ¬ãƒ³ãƒ‰</span>
            </div>
            <div class="trend-chart">
                <canvas id="trendCanvas"></canvas>
            </div>
        </div>

        <div class="analysis-section" style="display: none;" id="sentimentSection">
            <div class="section-title">
                <span>ğŸ˜Š</span>
                <span>æ„Ÿæƒ…åˆ†æ</span>
            </div>
            <div class="sentiment-analysis">
                <div class="sentiment-item">
                    <div class="sentiment-emoji">ğŸ˜Š</div>
                    <div class="sentiment-label">ãƒã‚¸ãƒ†ã‚£ãƒ–</div>
                    <div class="sentiment-percentage" id="positivePercent">-</div>
                </div>
                <div class="sentiment-item">
                    <div class="sentiment-emoji">ğŸ˜</div>
                    <div class="sentiment-label">ä¸­ç«‹</div>
                    <div class="sentiment-percentage" id="neutralPercent">-</div>
                </div>
                <div class="sentiment-item">
                    <div class="sentiment-emoji">ğŸ˜”</div>
                    <div class="sentiment-label">ã ã‚ã ã‚</div>
                    <div class="sentiment-percentage" id="negativePercent">-</div>
                </div>
            </div>
        </div>

        <div class="analysis-section" style="display: none;" id="keywordsSection">
            <div class="section-title">
                <span>ğŸ·ï¸</span>
                <span>é »å‡ºã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</span>
            </div>
            <div class="keywords-cloud" id="keywordsCloud">
                <!-- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚¿ã‚°ãŒå‹•çš„ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
            </div>
        </div>

        <div class="analysis-section" style="display: none;" id="recommendationsSection">
            <div class="section-title">
                <span>ğŸ’¡</span>
                <span>æ”¹å–„ææ¡ˆ</span>
            </div>
            <div class="recommendation-list" id="recommendationsList">
                <!-- æ”¹å–„ææ¡ˆãŒå‹•çš„ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
            </div>
        </div>
    </div>

    <script>
        // ã€é‡è¦ã€‘ã“ã“ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ãŸGoogle Apps Script Webã‚¢ãƒ—ãƒªã®URLã‚’è¨­å®šã—ã¦ãã ã•ã„
        const GAS_ENDPOINT_GET = 'https://script.google.com/macros/s/AKfycbzYwB9v0Hun9I2x5hz2-cfEEXH0pRphy4T2N61S_J0MGIPTFHXitCybI9cSVsd6C-jf/exec';
        
        let currentSurveyId = 1;
        let chartInstance = null;

        // è³ªå•å®šç¾©ï¼ˆsurvey4.htmlã¨åŒã˜ï¼‰
        const surveyQuestions = [
            { id: 1, type: 'radio', text: 'ã«ã’ã¾ã£ã—ã‚’ä½¿ã„å§‹ã‚ã¦ã©ã®ãã‚‰ã„ã«ãªã‚Šã¾ã™ã‹?' },
            { id: 2, type: 'rating', text: 'ã‚¢ãƒ—ãƒªã®ç·åˆçš„ãªæº€è¶³åº¦ã‚’æ•™ãˆã¦ãã ã•ã„' },
            { id: 3, type: 'checkbox', text: 'ã‚ˆãä½¿ã†æ©Ÿèƒ½ã‚’æ•™ãˆã¦ãã ã•ã„' },
            { id: 4, type: 'radio', text: 'é€šçŸ¥æ©Ÿèƒ½ã®é »åº¦ã«ã¤ã„ã¦ã€ã©ã†æ„Ÿã˜ã¦ã„ã¾ã™ã‹?' },
            { id: 5, type: 'rating', text: 'ã‚¢ãƒ—ãƒªã®ä½¿ã„ã‚„ã™ã•(æ“ä½œæ€§ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³)ã‚’è©•ä¾¡ã—ã¦ãã ã•ã„' },
            { id: 6, type: 'checkbox', text: 'è¿½åŠ ã—ã¦ã»ã—ã„æ©Ÿèƒ½ãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„' },
            { id: 7, type: 'textarea', text: 'æ”¹å–„ã—ã¦ã»ã—ã„ç‚¹ã‚„ä¸å…·åˆãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„' },
            { id: 8, type: 'textarea', text: 'ãã®ä»–ã€ã”æ„è¦‹ãƒ»ã”è¦æœ›ãŒã‚ã‚Œã°ãŠèã‹ã›ãã ã•ã„' }
        ];

        async function loadAnalysisData() {
            const urlParams = new URLSearchParams(window.location.search);
            currentSurveyId = Number(urlParams.get('id')) || 1;

            try {
                const response = await fetch(GAS_ENDPOINT_GET);
                const data = await response.json();
                
                if (data.result === "success") {
                    const surveyResponses = data.data.filter(res => Number(res.surveyId) === currentSurveyId);
                    
                    if (surveyResponses.length === 0) {
                        showNoDataMessage();
                        return;
                    }

                    const analysis = analyzeData(surveyResponses);
                    renderAnalysis(analysis);
                    showContent();
                    
                } else {
                    console.error('GASã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:', data.message);
                    showError();
                }
            } catch (error) {
                console.error('ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
                showError();
            }
        }

        function analyzeData(responses) {
            const analysis = {
                totalResponses: responses.length,
                completionRate: 100, // ç°¡æ˜“è¨ˆç®—
                avgSatisfaction: calculateAvgRating(responses, 2),
                avgUsability: calculateAvgRating(responses, 5),
                topFeatures: analyzeCheckboxQuestion(responses, 3),
                topIssues: analyzeCheckboxQuestion(responses, 6),
                sentiment: analyzeSentiment(responses),
                keywords: extractKeywords(responses),
                trend: calculateTrend(responses)
            };
            
            return analysis;
        }

        function calculateAvgRating(responses, questionId) {
            const ratings = responses
                .map(r => Number(r[String(questionId)]))
                .filter(r => !isNaN(r) && r >= 1 && r <= 5);
            
            if (ratings.length === 0) return 0;
            const sum = ratings.reduce((a, b) => a + b, 0);
            return (sum / ratings.length).toFixed(1);
        }

        function analyzeCheckboxQuestion(responses, questionId) {
            const counts = {};
            
            responses.forEach(res => {
                const answer = res[String(questionId)];
                if (answer && String(answer).trim() !== '') {
                    const options = String(answer).split(' | ').map(s => s.trim()).filter(s => s !== '');
                    options.forEach(option => {
                        counts[option] = (counts[option] || 0) + 1;
                    });
                }
            });

            return Object.entries(counts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
        }

        function analyzeSentiment(responses) {
            // æº€è¶³åº¦(Q2)ã¨ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£(Q5)ã‹ã‚‰ç°¡æ˜“çš„ã«æ„Ÿæƒ…åˆ†æ
            let positive = 0, neutral = 0, negative = 0;

            responses.forEach(res => {
                const satisfaction = Number(res['2']);
                const usability = Number(res['5']);
                const avg = (satisfaction + usability) / 2;

                if (avg >= 4) positive++;
                else if (avg >= 3) neutral++;
                else negative++;
            });

            const total = responses.length;
            return {
                positive: Math.round((positive / total) * 100),
                neutral: Math.round((neutral / total) * 100),
                negative: Math.round((negative / total) * 100)
            };
        }

        function extractKeywords(responses) {
            const keywords = {};
            const targetQuestions = [7, 8]; // ãƒ†ã‚­ã‚¹ãƒˆå›ç­”ã®è³ªå•

            targetQuestions.forEach(qId => {
                responses.forEach(res => {
                    const text = res[String(qId)];
                    if (text && String(text).trim() !== '') {
                        // ç°¡æ˜“çš„ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡ºï¼ˆã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šï¼‰
                        const words = String(text).split(/[\sã€ã€‚,.\n]+/)
                            .filter(w => w.length > 1);
                        
                        words.forEach(word => {
                            keywords[word] = (keywords[word] || 0) + 1;
                        });
                    }
                });
            });

            return Object.entries(keywords)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
        }

        function calculateTrend(responses) {
            // æ—¥ä»˜ã”ã¨ã®å¹³å‡æº€è¶³åº¦ã‚’è¨ˆç®—
            const dateGroups = {};

            responses.forEach(res => {
                const date = new Date(res.timestamp).toISOString().split('T')[0];
                if (!dateGroups[date]) {
                    dateGroups[date] = [];
                }
                const rating = Number(res['2']);
                if (!isNaN(rating)) {
                    dateGroups[date].push(rating);
                }
            });

            return Object.entries(dateGroups)
                .map(([date, ratings]) => ({
                    date: date,
                    avg: (ratings.reduce((a, b) => a + b, 0) / ratings.length).toFixed(1)
                }))
                .sort((a, b) => a.date.localeCompare(b.date));
        }

        function renderAnalysis(analysis) {
            // çµ±è¨ˆæƒ…å ±ã®æ›´æ–°
            document.getElementById('avgSatisfaction').innerHTML = 
                `${analysis.avgSatisfaction}<span style="font-size: 20px; color: #999;">/5.0</span>`;
            
            document.getElementById('satisfactionDesc').textContent = 
                `å¹³å‡ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£: ${analysis.avgUsability}/5.0`;

            document.getElementById('completionRate').innerHTML = 
                `${analysis.completionRate}<span style="font-size: 20px; color: #999;">%</span>`;

            // äººæ°—æ©Ÿèƒ½
            if (analysis.topFeatures.length > 0) {
                const [topFeature, count] = analysis.topFeatures[0];
                document.getElementById('topFeature').textContent = topFeature;
                document.getElementById('topFeatureDesc').textContent = 
                    `${count}ä»¶ã®åˆ©ç”¨ (${Math.round((count / analysis.totalResponses) * 100)}%)`;
            }

            // æœ€é‡è¦èª²é¡Œ
            if (analysis.topIssues.length > 0) {
                const [topIssue, count] = analysis.topIssues[0];
                document.getElementById('topIssue').textContent = topIssue;
                document.getElementById('topIssueDesc').textContent = 
                    `${Math.round((count / analysis.totalResponses) * 100)}%ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦æœ›`;
            }

            // æ„Ÿæƒ…åˆ†æ
            document.getElementById('positivePercent').textContent = analysis.sentiment.positive + '%';
            document.getElementById('neutralPercent').textContent = analysis.sentiment.neutral + '%';
            document.getElementById('negativePercent').textContent = analysis.sentiment.negative + '%';

            // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ã‚¦ãƒ‰
            const keywordsCloud = document.getElementById('keywordsCloud');
            keywordsCloud.innerHTML = analysis.keywords.map(([keyword, count]) => 
                `<div class="keyword-tag">${keyword} <span class="keyword-count">(${count})</span></div>`
            ).join('');

            // ãƒˆãƒ¬ãƒ³ãƒ‰ã‚°ãƒ©ãƒ•
            drawTrendChart(analysis.trend);

            // æ”¹å–„ææ¡ˆ
            renderRecommendations(analysis);
        }

        function drawTrendChart(trend) {
            const ctx = document.getElementById('trendCanvas');
            
            if (chartInstance) {
                chartInstance.destroy();
            }

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: trend.map(t => t.date),
                    datasets: [{
                        label: 'å¹³å‡æº€è¶³åº¦',
                        data: trend.map(t => t.avg),
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.3,
                        pointRadius: 5,
                        pointHoverRadius: 7
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 5,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        function renderRecommendations(analysis) {
            const recommendations = [
                {
                    icon: 'ğŸš€',
                    title: 'æ©Ÿèƒ½æ‹¡å……ã®æ¤œè¨',
                    priority: 'high',
                    text: `ã€Œ${analysis.topIssues[0]?.[0] || 'æ–°æ©Ÿèƒ½'}ã€ã¸ã®è¦æœ›ãŒé«˜ã¾ã£ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‹ãƒ¼ã‚ºã«å¿œãˆã‚‹æ©Ÿèƒ½è¿½åŠ ã‚’æ¤œè¨ã—ã¾ã—ã‚‡ã†ã€‚`
                },
                {
                    icon: 'â­',
                    title: 'æº€è¶³åº¦ã®ç¶­æŒãƒ»å‘ä¸Š',
                    priority: analysis.avgSatisfaction >= 4 ? 'medium' : 'high',
                    text: `ç¾åœ¨ã®æº€è¶³åº¦ã¯${analysis.avgSatisfaction}/5.0ã§ã™ã€‚${analysis.avgSatisfaction >= 4 ? 'é«˜ã„æ°´æº–ã‚’ç¶­æŒ' : 'æ”¹å–„ã®ä½™åœ°ãŒã‚ã‚Šã¾ã™'}ã€‚`
                },
                {
                    icon: 'ğŸ“±',
                    title: 'ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã®æ”¹å–„',
                    priority: analysis.avgUsability >= 4 ? 'low' : 'medium',
                    text: `æ“ä½œæ€§ã®è©•ä¾¡ã¯${analysis.avgUsability}/5.0ã§ã™ã€‚UI/UXã®ç¶™ç¶šçš„ãªæ”¹å–„ã‚’æ¨å¥¨ã—ã¾ã™ã€‚`
                }
            ];

            const list = document.getElementById('recommendationsList');
            list.innerHTML = recommendations.map(rec => `
                <div class="recommendation-item">
                    <div class="recommendation-icon">${rec.icon}</div>
                    <div class="recommendation-content">
                        <div class="recommendation-title">
                            ${rec.title}
                            <span class="priority-badge priority-${rec.priority}">
                                ${rec.priority === 'high' ? 'é«˜å„ªå…ˆåº¦' : rec.priority === 'medium' ? 'ä¸­å„ªå…ˆåº¦' : 'ä½å„ªå…ˆåº¦'}
                            </span>
                        </div>
                        <div class="recommendation-text">${rec.text}</div>
                    </div>
                </div>
            `).join('');
        }

        function showContent() {
            document.getElementById('loadingMessage').style.display = 'none';
            document.getElementById('mainContent').style.display = 'flex';
            document.getElementById('insightsGrid').style.display = 'grid';
            document.getElementById('trendSection').style.display = 'block';
            document.getElementById('sentimentSection').style.display = 'block';
            document.getElementById('keywordsSection').style.display = 'block';
            document.getElementById('recommendationsSection').style.display = 'block';
        }

        function showNoDataMessage() {
            document.getElementById('loadingMessage').innerHTML = 
                'ğŸ“­ ã“ã®ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã«ã¯ã¾ã å›ç­”ãŒã‚ã‚Šã¾ã›ã‚“ã€‚<br><br><button class="back-btn" onclick="goBack()">â† æˆ»ã‚‹</button>';
        }

        function showError() {
            document.getElementById('loadingMessage').innerHTML = 
                'âŒ ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚<br><br><button class="back-btn" onclick="goBack()">â† æˆ»ã‚‹</button>';
        }

        function goBack() {
            window.location.href = 'admin.html';
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
        window.addEventListener('load', loadAnalysisData);
    </script>
</body>
</html>
